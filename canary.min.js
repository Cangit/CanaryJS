/*!
 * Canary.js debug functions for your backbone.js powered applications
 * Based on RFC 5424 and Seldaek/monolog
 *
 */
var CanaryJS=Backbone.Model.extend({defaults:{name:"CanaryJS",level:0,console:!1,numberOfEntries:0},initialize:function(){this.set("debugCollection",new CanaryDebugCollection)},addEntry:function(a,b,c,e){this.get("level")<=e&&("undefined"==b?(this.get("debugCollection").add([{id:this.get("numberOfEntries"),type:c,msg:a}]),b=""):this.get("debugCollection").add([{id:this.get("numberOfEntries"),type:c,msg:a,obj:b}]),!0==this.get("console")&&this.get("debugCollection").writeToConsole({id:this.get("numberOfEntries"),
stamp:this.get("name"),type:c,msg:a,obj:b},!1),this.set("numberOfEntries",this.get("numberOfEntries")+1))},debug:function(a,b){"undefined"===typeof b?this.addEntry(a,"undefined","debug",100):this.addEntry(a,b,"debug",100)},info:function(a,b){"undefined"===typeof b?this.addEntry(a,"undefined","info",200):this.addEntry(a,b,"info",200)},notice:function(a,b){"undefined"===typeof b?this.addEntry(a,"undefined","notice",250):this.addEntry(a,b,"notice",250)},warning:function(a,b){"undefined"===typeof b?this.addEntry(a,
"undefined","warning",300):this.addEntry(a,b,"warning",300)},error:function(a,b){"undefined"===typeof b?this.addEntry(a,"undefined","error",400):this.addEntry(a,b,"error",400)},critical:function(a,b){"undefined"===typeof b?this.addEntry(a,"undefined","critical",500):this.addEntry(a,b,"critical",500)},getEntry:function(a){a=this.get("debugCollection").get(a);return{id:a.get("id"),type:a.get("type"),msg:a.get("msg"),obj:a.get("obj")}},dump:function(a){"undefined"===typeof a?console.group(this.get("name")):
console.group(a);this.get("debugCollection").walk(!1);console.groupEnd();return"/dump"},flush:function(a){"undefined"===typeof a?console.group(this.get("name")):console.group(a);this.get("debugCollection").walk(!0);console.groupEnd();this.set("numberOfEntries",0);return"/flush"},reset:function(){this.set("numberOfEntries",0);this.get("debugCollection").reset();return!0}}),CanaryDebug=Backbone.Model.extend({defaults:{id:0,type:"unknown",msg:"",obj:""}}),CanaryDebugCollection=Backbone.Collection.extend({model:CanaryDebug,
walk:function(a){var b=[],c=this;this.map(function(a){var d=a.get("id"),f=a.get("type"),g=a.get("msg");a=a.get("obj");c.writeToConsole({id:d,type:f,msg:g,obj:a},!0);b.push(d)});if(!0==a)for(a=0;a<b.length;a++)this.remove(b[a])},writeToConsole:function(a,b){var c=!0==b?"":a.stamp+"["+a.id+"] ";switch(a.type){case "debug":console.debug(c+a.msg,a.obj);break;case "info":case "notice":console.info(c+a.msg,a.obj);break;case "warning":console.warn(c+a.msg,a.obj);break;case "error":case "critical":console.error(c+
a.msg,a.obj)}}});